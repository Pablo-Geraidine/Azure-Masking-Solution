Private Sub Workbook_Open()
    Dim ws As Worksheet
    Dim headerCell As Range
    Dim lastRow As Long
    Dim namedRange As Range
    Dim rangeName As String
    
    ' Process config1 sheet
    Set ws = Sheets("config1")
    For Each headerCell In ws.Range("A1", ws.Cells(1, ws.Cells(1, Columns.Count).End(xlToLeft).Column))
        lastRow = ws.Cells(ws.Rows.Count, headerCell.Column).End(xlUp).Row
        Set namedRange = ws.Range(headerCell.Offset(1, 0), ws.Cells(lastRow, headerCell.Column))
        rangeName = Replace(headerCell.Value, " ", "_") ' Replace spaces with underscores
        ThisWorkbook.Names.Add Name:=rangeName, RefersTo:=namedRange
    Next headerCell
    
    ' Process config2 sheet
    Set ws = Sheets("config2")
    For Each headerCell In ws.Range("A1", ws.Cells(1, ws.Cells(1, Columns.Count).End(xlToLeft).Column))
        lastRow = ws.Cells(ws.Rows.Count, headerCell.Column).End(xlUp).Row
        Set namedRange = ws.Range(headerCell.Offset(1, 0), ws.Cells(lastRow, headerCell.Column))
        rangeName = Replace(headerCell.Value, " ", "_") ' Replace spaces with underscores
        rangeName = Replace(rangeName, "#", "_")
        rangeName = Replace(rangeName, ".", "_")
        rangeName = Replace(rangeName, "-", "_")
        rangeName = Replace(rangeName, "(", "_")
        rangeName = Replace(rangeName, ")", "_")
        rangeName = Replace(rangeName, "/", "_")
        ThisWorkbook.Names.Add Name:=rangeName, RefersTo:=namedRange
    Next headerCell
End Sub

